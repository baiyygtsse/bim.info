(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-727ad504","chunk-b724fa14"],{4158:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search"},[e("Card",{staticStyle:{"margin-bottom":"10px"}},[e("div",{attrs:{slot:"title"},slot:"title"},[e("div",{staticClass:"edit-head"},[e("a",{staticClass:"back-title",on:{click:t.close}},[e("Icon",{attrs:{type:"ios-arrow-back"}}),t._v("返回 ")],1),e("div",{staticClass:"head-name"},[t._v("流程审批进度历史")]),e("span"),e("a",{staticClass:"window-close",on:{click:t.close}},[e("Icon",{staticClass:"ivu-icon-ios-close",attrs:{type:"ios-close",size:"31"}})],1)])]),e("div",{staticStyle:{position:"relative"}},[e("Table",{ref:"table",attrs:{loading:t.loading,border:"",columns:t.columns,data:t.data}}),e("div",{staticClass:"img-title"},[t._v("实时流程图")]),e("div",{staticStyle:{position:"relative"}},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.imgUrl,expression:"imgUrl"}]}),t.loadingImg?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1),t.loading?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)])],1)},i=[],r=s("81c1"),n=s("c276"),o={name:"historic_detail",props:{procInstId:String},data(){return{loading:!1,loadingImg:!1,columns:[{type:"selection",width:60,align:"center"},{type:"index",width:60,align:"center"},{title:"任务名称",key:"name",minWidth:120,sortable:!0},{title:"处理人",key:"assignees",align:"center",sortable:!0,minWidth:150,render:(t,e)=>{if(e.row.assignees)return t("div",e.row.assignees.map((function(e,s){return e.isExecutor?t("Tooltip",{props:{placement:"top",content:e.username}},[t("Tag",{style:{"margin-right":"8px"},props:{type:"border",color:"primary"}},e.nickname)]):t("Tooltip",{props:{placement:"top",content:e.username}},[t("Tag",{style:{"margin-right":"8px"},props:{type:"border"}},e.nickname)])})))}},{title:"审批操作",key:"deleteReason",align:"center",minWidth:150,sortable:!0},{title:"审批意见",key:"comment",align:"center",minWidth:120,sortable:!0},{title:"耗时",key:"duration",align:"center",width:100,sortable:!0,render:(t,e)=>t("div",n["a"].millsToTime(e.row.duration))},{title:"创建时间",key:"createTime",width:170,sortType:"asc",sortable:!0},{title:"完成时间",key:"endTime",width:170,sortable:!0},{title:"状态",align:"center",width:120,render:(t,e)=>{let s="",a="";return e.row.endTime?(a="blue",s="已办理"):(a="default",s="待处理"),t("div",[t("Tag",{props:{color:a}},s)])}}],data:[],id:"",imgUrl:"",backRoute:""}},methods:{init(){this.$route.query.id?(this.id=this.$route.query.id,this.backRoute=this.$route.query.backRoute):this.id=this.procInstId,this.imgUrl=r["D"]+this.id+"?accessToken="+this.getStore("accessToken")+"&time="+new Date,this.getDataList()},getDataList(){this.loading=!0,Object(r["M"])(this.id).then(t=>{this.loading=!1,t.success&&(this.data=t.result,t.result&&0!=t.result.length||this.$Modal.info({title:"未找到该记录审批历史数据",content:"历史数据可能已被删除"}))})},close(){this.$route.query.id?(this.$store.commit("removeTag","historic_detail"),localStorage.pageOpenedList=JSON.stringify(this.$store.state.app.pageOpenedList),this.$router.push({name:this.backRoute})):this.$emit("close",!0)}},mounted(){this.init()},watch:{$route(t,e){"historic_detail"==t.name&&this.init()}}},c=o,l=(s("6a25"),s("2877")),d=Object(l["a"])(c,a,i,!1,null,null,null);e["default"]=d.exports},"5ad2":function(t,e,s){"use strict";s("b257")},"6a25":function(t,e,s){"use strict";s("8be0")},"6c6d":function(t,e,s){"use strict";s.d(e,"a",(function(){return a}));const a=[{text:"今日",value(){var t=new Date,e=new Date;return t.setTime(e.getTime()),[e,t]}},{text:"昨日",value(){var t=new Date,e=new Date;return e.setTime(e.getTime()-864e5),t.setTime(t.getTime()-864e5),[e,t]}},{text:"本周",value(){var t=new Date,e=t.getDay(),s=t.getDate(),a=t.getMonth(),i=e||7,r=new Date(t.getFullYear(),a,s+1-i),n=new Date(t.getFullYear(),a,s+7-i);return r.setTime(r.getTime()),n.setTime(n.getTime()),[r,n]}},{text:"本月",value(){var t=new Date,e=t.getYear();e+=e<2e3?1900:0;var s=t.getMonth(),a=new Date(e,s,1),i=new Date(e,s+1,1),r=(i-a)/864e5,n=new Date(e,s,1),o=new Date(e,s,r);return n.setTime(n.getTime()),o.setTime(o.getTime()),[n,o]}}]},"81c1":function(t,e,s){"use strict";s.d(e,"x",(function(){return i})),s.d(e,"r",(function(){return r})),s.d(e,"y",(function(){return n})),s.d(e,"D",(function(){return o})),s.d(e,"F",(function(){return c})),s.d(e,"c",(function(){return l})),s.d(e,"s",(function(){return d})),s.d(e,"o",(function(){return u})),s.d(e,"J",(function(){return h})),s.d(e,"U",(function(){return m})),s.d(e,"X",(function(){return p})),s.d(e,"i",(function(){return g})),s.d(e,"K",(function(){return b})),s.d(e,"v",(function(){return f})),s.d(e,"w",(function(){return y})),s.d(e,"p",(function(){return w})),s.d(e,"L",(function(){return v})),s.d(e,"B",(function(){return k})),s.d(e,"I",(function(){return T})),s.d(e,"C",(function(){return O})),s.d(e,"G",(function(){return D})),s.d(e,"H",(function(){return j})),s.d(e,"V",(function(){return I})),s.d(e,"q",(function(){return S})),s.d(e,"j",(function(){return x})),s.d(e,"T",(function(){return F})),s.d(e,"t",(function(){return L})),s.d(e,"M",(function(){return P})),s.d(e,"k",(function(){return $})),s.d(e,"P",(function(){return C})),s.d(e,"Q",(function(){return z})),s.d(e,"z",(function(){return M})),s.d(e,"e",(function(){return _})),s.d(e,"f",(function(){return B})),s.d(e,"g",(function(){return N})),s.d(e,"n",(function(){return R})),s.d(e,"N",(function(){return A})),s.d(e,"O",(function(){return V})),s.d(e,"a",(function(){return W})),s.d(e,"u",(function(){return H})),s.d(e,"l",(function(){return U})),s.d(e,"R",(function(){return E})),s.d(e,"A",(function(){return q})),s.d(e,"d",(function(){return J})),s.d(e,"S",(function(){return Y})),s.d(e,"h",(function(){return K})),s.d(e,"m",(function(){return G})),s.d(e,"E",(function(){return Q})),s.d(e,"b",(function(){return X})),s.d(e,"W",(function(){return Z}));var a=s("7f80");const i="/xboot/actModel/export/",r="/xboot/actModel/deployByFile",n="/xboot/actProcess/export",o="/xboot/actProcess/getHighlightImg/",c=t=>Object(a["b"])("/actModel/getByCondition",t),l=t=>Object(a["e"])("/actModel/add",t),d=(t,e)=>Object(a["b"])("/actModel/deploy/"+t,e),u=t=>Object(a["e"])("/actModel/delByIds",t),h=t=>Object(a["b"])("/actProcess/getByCondition",t),m=t=>Object(a["e"])("/actProcess/updateInfo",t),p=t=>Object(a["e"])("/actProcess/updateStatus",t),g=(t,e)=>Object(a["b"])("/actProcess/convertToModel/"+t,e),b=(t,e)=>Object(a["b"])("/actProcess/getProcessNode/"+t,e),f=t=>Object(a["e"])("/actProcess/editNodeUser",t),y=t=>Object(a["e"])("/actProcess/editStartUser",t),w=t=>Object(a["e"])("/actProcess/delByIds",t),v=t=>Object(a["b"])("/actProcess/getRunningProcess",t),k=t=>Object(a["b"])("/actProcess/getFinishedProcess",t),T=(t,e)=>Object(a["b"])("/actProcess/getByKey/"+t,e),O=(t,e)=>Object(a["b"])("/actProcess/getFirstNode/"+t,e),D=(t,e,s)=>Object(a["b"])(`/actProcess/getNextNode/${t}/${e}`,s),j=(t,e)=>Object(a["b"])("/actProcess/getNode/"+t,e),I=t=>Object(a["e"])("/actProcess/updateInsStatus",t),S=t=>Object(a["e"])("/actProcess/delInsByIds",t),x=t=>Object(a["e"])("/actProcess/delHistoricInsByIds",t),F=t=>Object(a["b"])("/actTask/todoList",t),L=t=>Object(a["b"])("/actTask/doneList",t),P=(t,e)=>Object(a["b"])("/actTask/historicFlow/"+t,e),$=t=>Object(a["e"])("/actTask/delegate",t),C=t=>Object(a["e"])("/actTask/pass",t),z=t=>Object(a["e"])("/actTask/passAll",t),M=(t,e)=>Object(a["b"])("/actTask/getBackList/"+t,e),_=t=>Object(a["e"])("/actTask/back",t),B=t=>Object(a["e"])("/actTask/backAll",t),N=t=>Object(a["e"])("/actTask/backToTask",t),R=t=>Object(a["e"])("/actTask/deleteHistoric",t),A=t=>Object(a["b"])("/actCategory/getByParentId/0",t),V=(t,e)=>Object(a["b"])("/actCategory/getByParentId/"+t,e),W=t=>Object(a["e"])("/actCategory/add",t),H=t=>Object(a["e"])("/actCategory/edit",t),U=t=>Object(a["e"])("/actCategory/delByIds",t),E=t=>Object(a["b"])("/actCategory/search",t),q=t=>Object(a["b"])("/actBusiness/getByCondition",t),J=t=>Object(a["e"])("/actBusiness/apply",t),Y=t=>Object(a["e"])("/actBusiness/start",t),K=t=>Object(a["e"])("/actBusiness/cancel",t),G=t=>Object(a["e"])("/actBusiness/delByIds",t),Q=(t,e)=>Object(a["b"])("/leave/get/"+t,e),X=t=>Object(a["e"])("/leave/add",t),Z=t=>Object(a["f"])("/leave/update",t)},"8be0":function(t,e,s){},"97a9":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search"},[t.showHistory?e("historicDetail",{attrs:{procInstId:t.procInstId},on:{close:function(e){t.showHistory=!1}}}):t._e(),e("Card",{directives:[{name:"show",rawName:"v-show",value:!t.showHistory,expression:"!showHistory"}]},[e("Row",{directives:[{name:"show",rawName:"v-show",value:t.openSearch,expression:"openSearch"}],nativeOn:{keydown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch.apply(null,arguments)}}},[e("Form",{ref:"searchForm",attrs:{model:t.searchForm,inline:"","label-width":70}},[e("FormItem",{attrs:{label:"任务名称",prop:"name"}},[e("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入",clearable:""},model:{value:t.searchForm.name,callback:function(e){t.$set(t.searchForm,"name",e)},expression:"searchForm.name"}})],1),e("FormItem",{attrs:{label:"创建时间"}},[e("DatePicker",{staticStyle:{width:"200px"},attrs:{options:t.options,type:"daterange",format:"yyyy-MM-dd",clearable:"",placeholder:"选择起始时间"},on:{"on-change":t.selectDateRange},model:{value:t.selectDate,callback:function(e){t.selectDate=e},expression:"selectDate"}})],1),e("FormItem",{staticClass:"br",staticStyle:{"margin-left":"-35px"}},[e("Button",{attrs:{type:"primary",icon:"ios-search"},on:{click:t.handleSearch}},[t._v("搜索")]),e("Button",{on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1),e("Row",{staticClass:"operation",attrs:{align:"middle",justify:"space-between"}},[e("div",[e("Button",{attrs:{icon:"md-trash"},on:{click:t.delAll}},[t._v("批量删除")])],1),e("div",{staticClass:"icons"},[e("Tooltip",{attrs:{content:"刷新",placement:"top",transfer:""}},[e("Icon",{staticClass:"item",attrs:{type:"md-refresh",size:"18"},on:{click:t.getDataList}})],1),e("Tooltip",{attrs:{content:t.openSearch?"关闭搜索":"开启搜索",placement:"top",transfer:""}},[e("Icon",{staticClass:"item tip",attrs:{type:"ios-search",size:"18"},on:{click:function(e){t.openSearch=!t.openSearch}}})],1),e("Tooltip",{attrs:{content:t.openTip?"关闭提示":"开启提示",placement:"top",transfer:""}},[e("Icon",{staticClass:"item tip",attrs:{type:"md-bulb",size:"18"},on:{click:function(e){t.openTip=!t.openTip}}})],1),e("Tooltip",{attrs:{content:"表格密度",placement:"top",transfer:""}},[e("Dropdown",{attrs:{trigger:"click"},on:{"on-click":t.changeTableSize}},[e("Icon",{staticClass:"item",attrs:{type:"md-list",size:"18"}}),e("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[e("DropdownItem",{attrs:{selected:"default"==t.tableSize,name:"default"}},[t._v("默认")]),e("DropdownItem",{attrs:{selected:"large"==t.tableSize,name:"large"}},[t._v("宽松")]),e("DropdownItem",{attrs:{selected:"small"==t.tableSize,name:"small"}},[t._v("紧密")])],1)],1)],1),e("Tooltip",{attrs:{content:"导出数据",placement:"top",transfer:""}},[e("Icon",{staticClass:"item",attrs:{type:"md-download",size:"18"},on:{click:t.exportData}})],1)],1)]),e("Alert",{directives:[{name:"show",rawName:"v-show",value:t.openTip,expression:"openTip"}],attrs:{"show-icon":""}},[t._v(" 已选择 "),e("span",{staticClass:"select-count"},[t._v(t._s(t.selectList.length))]),t._v(" 项 "),e("a",{staticClass:"select-clear",on:{click:t.clearSelectAll}},[t._v("清空")])]),e("Table",{ref:"table",attrs:{loading:t.loading,border:"",columns:t.columns,sortable:"custom",data:t.data,size:t.tableSize},on:{"on-sort-change":t.changeSort,"on-selection-change":t.showSelect}}),e("Row",{staticClass:"page",attrs:{type:"flex",justify:"end"}},[e("Page",{attrs:{current:t.searchForm.pageNumber,total:t.total,"page-size":t.searchForm.pageSize,"page-size-opts":[10,20,50],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}})],1)],1),e("Modal",{attrs:{title:t.modalTitle,"mask-closable":!1,width:500},model:{value:t.modalVisible,callback:function(e){t.modalVisible=e},expression:"modalVisible"}},[e("Form",{ref:"form",attrs:{model:t.form,"label-width":70,rules:t.formValidate}},[e("FormItem",{attrs:{label:"删除原因",prop:"reason"}},[e("Input",{attrs:{type:"textarea",rows:4},model:{value:t.form.reason,callback:function(e){t.$set(t.form,"reason",e)},expression:"form.reason"}})],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"text"},on:{click:t.handelCancel}},[t._v("取消")]),e("Button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.handelSubmit}},[t._v("提交")])],1)],1)],1)},i=[],r=s("81c1"),n=s("365c"),o=s("c276"),c=s("4158"),l=s("6c6d"),d={name:"done-manage",components:{historicDetail:c["default"]},data(){return{tableSize:"default",showHistory:!1,procInstId:"",openSearch:!0,openTip:!0,loading:!0,selectList:[],searchForm:{name:"",pageNumber:1,pageSize:10,sort:"createTime",order:"desc"},selectDate:null,options:{shortcuts:l["a"]},modalType:0,modalVisible:!1,modalTitle:"",form:{reason:""},formValidate:{},submitLoading:!1,columns:[{type:"selection",width:60,align:"center"},{type:"index",width:60,align:"center"},{title:"任务名称",key:"name",minWidth:160},{title:"所属流程",key:"processName",minWidth:150,render:(t,e)=>{let s="";return e.row.version&&(s=e.row.processName+" - v."+e.row.version),t("div",[t("span",s)])}},{title:"委托代办人",key:"owner",minWidth:130,align:"center",render:(t,e)=>e.row.owner?t("Tooltip",{props:{placement:"top",content:e.row.ownerUsername}},[t("Tag",{style:{"margin-right":"8px"},props:{type:"border"}},e.row.owner)]):t("span","-")},{title:"流程发起人",key:"applyer",minWidth:130,align:"center",render:(t,e)=>t("Tooltip",{props:{placement:"top",content:e.row.applyerUsername}},[t("Tag",{style:{"margin-right":"8px"},props:{type:"border"}},e.row.applyer)])},{title:"优先级",key:"priority",width:100,sortable:!0,align:"center",render:(t,e)=>{let s="无";return this.dictPriority.forEach(t=>{t.value==e.row.priority&&(s=t.title)}),t("div",s)}},{title:"审批操作",key:"deleteReason",align:"center",minWidth:130},{title:"审批意见",key:"comment",align:"center",minWidth:130},{title:"耗时",key:"duration",align:"center",width:100,sortable:!0,render:(t,e)=>t("div",o["a"].millsToTime(e.row.duration))},{title:"创建时间",key:"createTime",width:180,sortType:"desc",sortable:!0},{title:"操作",key:"action",align:"center",width:220,fixed:"right",render:(t,e)=>t("div",[t("a",{on:{click:()=>{this.detail(e.row)}}},"表单数据"),t("Divider",{props:{type:"vertical"}}),t("a",{on:{click:()=>{this.history(e.row)}}},"审批历史"),t("Divider",{props:{type:"vertical"}}),t("a",{on:{click:()=>{this.remove(e.row)}}},"删除")])}],data:[],total:0,deleteId:"",dictPriority:[]}},methods:{init(){this.getDictDataType(),this.getDataList()},getDictDataType(){Object(n["Ab"])("priority").then(t=>{t.success&&(this.dictPriority=t.result)})},changeSort(t){this.searchForm.sort=t.key,this.searchForm.order=t.order,"normal"==t.order&&(this.searchForm.order=""),this.getDataList()},changePage(t){this.searchForm.pageNumber=t,this.getDataList(),this.clearSelectAll()},changePageSize(t){this.searchForm.pageSize=t,this.getDataList()},selectDateRange(t){t&&(this.searchForm.startDate=t[0],this.searchForm.endDate=t[1])},changeTableSize(t){this.tableSize=t},exportData(){this.$refs.table.exportCsv({filename:"数据"})},getDataList(){this.loading=!0,Object(r["t"])(this.searchForm).then(t=>{this.loading=!1,t.success&&(this.data=t.result.content,this.total=t.result.totalElements,0==this.data.length&&this.searchForm.pageNumber>1&&(this.searchForm.pageNumber-=1,this.getDataList()))})},handleSearch(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.getDataList()},handleReset(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.selectDate=null,this.searchForm.startDate="",this.searchForm.endDate="",this.getDataList()},showSelect(t){this.selectList=t},clearSelectAll(){this.$refs.table.selectAll(!1)},handelCancel(){this.modalVisible=!1},handelSubmit(){this.$refs.form.validate(t=>{if(t)if(this.submitLoading=!0,0==this.modalType)deleteProcessIns({ids:this.deleteId}).then(t=>{this.submitLoading=!1,t.success&&(this.$Message.success("操作成功"),this.modalVisible=!1,this.getDataList())});else if(1==this.modalType){let t="";this.selectList.forEach((function(e){t+=e.id+","})),t=t.substring(0,t.length-1),deleteProcessIns({ids:t}).then(t=>{this.submitLoading=!1,t.success&&(this.$Message.success("操作成功"),this.modalVisible=!1,this.clearSelectAll(),this.getDataList())})}})},editStatus(t,e){let s="";s=0==t?"暂停挂起":"激活运行",this.$Modal.confirm({title:"确认"+s,content:`您确认要${s}流程实例${e.name}?`,loading:!0,onOk:()=>{let s={status:t,id:e.id};Object(r["V"])(s).then(t=>{this.$Modal.remove(),t.success&&(this.$Message.success("操作成功"),this.getDataList())})}})},detail(t){let e={id:t.tableId,type:3,backRoute:this.$route.name};this.$router.push({name:t.routeName,query:e})},history(t){t.procInstId?(this.procInstId=t.procInstId,this.showHistory=!0):this.$Message.error("流程实例ID不存在")},remove(t){this.$Modal.confirm({title:"确认删除",content:"您确认要删除 "+t.name+" ?",loading:!0,onOk:()=>{Object(r["n"])({ids:t.id}).then(t=>{this.$Modal.remove(),t.success&&(this.clearSelectAll(),this.$Message.success("操作成功"),this.getDataList())})}})},delAll(){this.selectList.length<=0?this.$Message.warning("您还未选择要删除的数据"):(this.modalTitle="确认要删除所选的 "+this.selectList.length+" 条数据",this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectList.length+" 条数据?",loading:!0,onOk:()=>{let t="";this.selectList.forEach((function(e){t+=e.id+","})),t=t.substring(0,t.length-1),Object(r["n"])({ids:t}).then(t=>{this.$Modal.remove(),t.success&&(this.$Message.success("操作成功"),this.clearSelectAll(),this.getDataList())})}}))}},mounted(){this.init()},watch:{$route(t,e){"done-manage"==t.name&&this.getDataList()}}},u=d,h=(s("5ad2"),s("2877")),m=Object(h["a"])(u,a,i,!1,null,null,null);e["default"]=m.exports},b257:function(t,e,s){}}]);