(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-79bdaabe","chunk-2d22493d"],{"0808":function(e,t,s){},"1f5f":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[t("Modal",{attrs:{title:"我的"+e.mode,width:904},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.urlMode,expression:"!urlMode"}]},[t("div",{staticClass:"upload-nav"},[t("div",{staticStyle:{display:"flex"}},[e.showUpload?t("Upload",{attrs:{action:e.uploadFileUrl,headers:e.accessToken,data:e.uploadData,"on-success":e.handleSuccess,"on-error":e.handleError,format:e.format,accept:e.accept,"max-size":1024*e.maxSize,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.beforeUpload,"show-upload-list":!1}},[t("Button",{attrs:{loading:e.loading,icon:e.icon,disabled:!e.searchForm.categoryId}},[e._v("上传"+e._s(e.mode))])],1):e._e(),e.showInput?t("Button",{staticStyle:{"margin-left":"5px"},attrs:{icon:"ios-image-outline",disabled:!e.searchForm.categoryId},on:{click:function(t){e.urlMode=!0}}},[e._v("网络"+e._s(e.mode))]):e._e(),t("Input",{staticStyle:{width:"230px","margin-left":"5px"},attrs:{suffix:"ios-search",placeholder:"输入文件名搜索",clearable:""},on:{"on-change":e.getDataList},model:{value:e.searchForm.title,callback:function(t){e.$set(e.searchForm,"title",t)},expression:"searchForm.title"}})],1),t("Button",{attrs:{icon:"md-refresh"},on:{click:e.getDataList}},[e._v("刷新")])],1),t("div",{staticClass:"content-wrap"},[t("div",{staticClass:"category"},[t("fileCategory",{attrs:{showOnly:""},on:{"on-select":e.selectCategory}})],1),t("div",{staticClass:"content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:0==e.total,expression:"total == 0"}],staticClass:"empty"},[e._v(" 暂无数据，点击左上角上传按钮添加 ")]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total > 0"}],staticClass:"wrap"},[e._l(e.data,(function(i,a){return t("div",{key:a,class:{item:!i.selected,"item active":i.selected},style:{marginRight:(a+1)%5==0?"0px":"10px",marginBottom:a<5?"20px":"0px"}},[t("div",{staticClass:"preview",on:{click:function(t){return e.changeSelect(i)}}},[i.isCollect?t("div",{staticClass:"collect-icon"},[t("Icon",{attrs:{type:"md-star",color:"#ffc60a",size:"16"}})],1):e._e(),"图片"==e.mode?t("img",{staticClass:"img",attrs:{src:i.url}}):t("div",{staticClass:"video"},[t("video",{staticClass:"cover"},[t("source",{attrs:{src:i.url+"#t=1",preload:"metadata"}})]),t("img",{staticClass:"play",attrs:{src:s("565b")}})]),t("div",{directives:[{name:"show",rawName:"v-show",value:i.selected,expression:"item.selected"}],staticClass:"border"}),t("div",{staticClass:"border-hover"}),t("img",{directives:[{name:"show",rawName:"v-show",value:i.selected,expression:"item.selected"}],staticClass:"select",attrs:{src:s("592c")}})]),t("Tooltip",{attrs:{content:`${i.title} ${e.util.getFileSize(i.size)}`,placement:"top","max-width":500}},[t("div",{staticClass:"title"},[e._v(e._s(i.title))])]),e.showMenus?t("div",{staticClass:"ops"},[t("a",{on:{click:function(t){return e.preview(i)}}},[e._v("预览")]),t("Divider",{attrs:{type:"vertical"}}),e.readonly?t("a",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:i.url,expression:"item.url",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}]},[e._v(" 复制链接 ")]):e._e(),e.readonly?e._e():t("Poptip",{attrs:{width:"350"}},[t("a",[e._v("编辑")]),t("div",{staticClass:"edit",attrs:{slot:"content"},slot:"content"},[e._v(" 文件名： "),t("Input",{staticStyle:{width:"280px"},attrs:{search:"","enter-button":"提交"},on:{"on-search":function(t){return e.editName(i)}},model:{value:i.newName,callback:function(t){e.$set(i,"newName",t)},expression:"item.newName"}})],1)]),e.readonly?e._e():t("Divider",{attrs:{type:"vertical"}}),e.readonly?e._e():t("Dropdown",[t("a",[e._v("更多")]),t("DropdownMenu",{staticClass:"block-pop",attrs:{slot:"list"},slot:"list"},[t("div",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:i.url,expression:"item.url",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:e.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:e.onError,expression:"onError",arg:"error"}],staticClass:"ivu-dropdown-item"},[e._v(" 复制链接 ")]),t("div",{staticClass:"ivu-dropdown-item",on:{click:function(t){return e.collect(i)}}},[e._v(" "+e._s(i.isCollect?"取消收藏":"收藏")+" ")]),t("Poptip",{attrs:{confirm:"",title:"确认将此素材移动至回收站？"},on:{"on-ok":function(t){return e.del(i)}}},[t("div",{staticClass:"ivu-dropdown-item"},[e._v("删除")])])],1)],1)],1):e._e()],1)})),t("Spin",{directives:[{name:"show",rawName:"v-show",value:e.dataLoading,expression:"dataLoading"}],attrs:{fix:""}})],2),t("div",{staticClass:"bottom"},[t("div",{staticClass:"select-count"},[e._v(" "+e._s(e.selectList.length>0?`已选 ${e.selectList.length} 项`:"")+" ")]),t("Page",{attrs:{current:e.searchForm.pageNumber,total:e.total,"page-size":e.searchForm.pageSize,size:"small","show-total":"","show-elevator":""},on:{"on-change":e.changePage}})],1)])])]),t("div",{directives:[{name:"show",rawName:"v-show",value:e.urlMode,expression:"urlMode"}]},[t("div",{staticClass:"upload-nav"},[t("Button",{attrs:{icon:"ios-arrow-back"},on:{click:function(t){e.urlMode=!1}}},[e._v("返回")])],1),t("div",{staticStyle:{width:"100%",display:"flex"}},[t("Form",{ref:"form",staticStyle:{"margin-right":"10px"},attrs:{model:e.form,"label-position":"left","label-width":100,rules:e.ruleValidate}},[t("FormItem",{attrs:{label:e.mode+"链接",prop:"url"}},[t("Input",{style:"width: "+("图片"==e.mode?"600px":"720px"),attrs:{type:"textarea",rows:5,maxlength:e.maxlength,"show-word-limit":"",placeholder:`请输入${e.mode}链接...`},model:{value:e.form.url,callback:function(t){e.$set(e.form,"url",t)},expression:"form.url"}})],1)],1),"图片"==e.mode?t("div",[e.form.url?t("Avatar",{attrs:{shape:"square",src:e.form.url,size:"110"}}):t("Avatar",{attrs:{shape:"square",icon:"md-images",size:"110"}})],1):e._e()],1)]),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:function(t){e.modalVisible=!1}}},[e._v("取消")]),t("Button",{attrs:{disabled:0==e.selectList.length&&!e.urlMode||!e.form.url&&e.urlMode,type:"primary"},on:{click:e.handelSubmit}},[e._v("确定")])],1)]),"视频"==e.mode?t("Modal",{attrs:{title:e.videoTitle,width:800,draggable:"","footer-hide":""},on:{"on-cancel":e.closeVideo},model:{value:e.videoVisible,callback:function(t){e.videoVisible=t},expression:"videoVisible"}},[t("div",{staticStyle:{height:"500px"},attrs:{id:e.videoId}})]):e._e()],1)},a=[],o=(s("0808"),s("6a37")),l=s.n(o),r=s("c06d"),c=s.n(r),d=s("c276"),n=s("365c"),h=s("e172"),m={name:"materialCenter",components:{fileCategory:h["default"]},props:{value:{type:Boolean,default:!1},mode:{validator(e){return d["a"].oneOf(e,["图片","视频"])},type:String,default:"图片"},multiple:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},showMenus:{type:Boolean,default:!0},showUpload:{type:Boolean,default:!0},showInput:{type:Boolean,default:!0},maxlength:{type:Number,default:250},icon:{type:String,default:"ios-cloud-upload-outline"},maxSize:{type:Number,default:5},acceptImg:{type:String,default:".jpg, .jpeg, .png, .gif"},acceptVideo:{type:String,default:".mp4, .wmv, .avi, .mov, .flv, .mkv"}},computed:{format(){if(this.accept){let e=[];return this.accept.split(",").forEach(t=>{e.push(t.replace(".","").replace(" ",""))}),e}return[]}},data(){return{uploadData:{},accessToken:{},accept:"",urlMode:!1,modalVisible:this.value,loading:!1,dataLoading:!1,uploadFileUrl:n["Tc"],searchForm:{title:"",type:"image",pageNumber:1,pageSize:10,categoryId:"0",isCollect:null},total:0,data:[],selectList:[],form:{url:""},ruleValidate:{url:[{required:!0,message:"请输入合法的URL链接",type:"url"}]},dp:null,videoVisible:!1,videoTitle:"",videoId:"dplayer"}},methods:{init(){this.accessToken={accessToken:this.getStore("accessToken")},this.changeAccept(),this.getDataList()},selectCategory(e){"-1"==e.id?(this.searchForm.categoryId="",this.searchForm.isCollect=!0,this.getDataList()):(this.searchForm.isCollect=null,this.searchForm.categoryId=e.id,this.uploadData={categoryId:e.id},this.currCate=e.title,this.getDataList())},changeAccept(){"图片"==this.mode?this.accept=this.acceptImg:"视频"==this.mode&&(this.accept=this.acceptVideo)},changePage(e){this.searchForm.pageNumber=e,this.getDataList()},getDataList(){this.dataLoading=!0,"视频"==this.mode&&(this.searchForm.type="video"),Object(n["dc"])(this.searchForm).then(e=>{this.dataLoading=!1,e.success&&(this.data=e.result.content,this.data.forEach(e=>{e.newName=e.title,e.selected=!1,e.border=!1}),this.total=e.result.totalElements,0==this.data.length&&this.searchForm.pageNumber>1&&(this.searchForm.pageNumber-=1,this.getDataList()))})},clearSelectAll(){this.selectList=[]},changeSelect(e){e.selected=!e.selected,this.multiple?e.selected?this.selectList.push(e):this.selectList=this.selectList.filter(t=>t.id!=e.id):e.selected?(this.selectList.length>0&&(this.selectList[0].selected=!1,this.selectList=[]),this.selectList.push(e)):this.selectList=[]},handelSubmit(){let e=[];this.urlMode?this.$refs.form.validate(t=>{t&&(e.push(this.form.url),this.multiple?this.$emit("on-change",e):this.$emit("on-change",e[0]),this.modalVisible=!1)}):(this.selectList.forEach(t=>{e.push(t.url)}),this.multiple?this.$emit("on-change",e):this.$emit("on-change",e[0]),this.modalVisible=!1)},preview(e){"图片"==this.mode?this.viewImage(e):this.showVideo(e)},viewImage(e){let t=new Image;t.src=e.url;let s=new l.a(t,{hidden:function(){s.destroy()}});s.show()},showVideo(e){this.dp=new c.a({container:document.getElementById(this.videoId),screenshot:!0,video:{url:e.url}}),this.videoTitle=e.title,this.videoVisible=!0},closeVideo(){this.dp&&this.dp.destroy()},collect(e){Object(n["v"])({id:e.id}).then(t=>{this.$Modal.remove(),t.success&&(this.$Message.success(e.isCollect?"取消收藏成功":"收藏成功"),this.getDataList())})},onCopy(){this.$Message.success("复制链接成功")},onError(){this.$Message.warning("复制链接失败，请手动复制")},editName(e){Object(n["vc"])(e).then(e=>{e.success&&(this.$Message.success("操作成功"),this.getDataList())})},del(e){Object(n["Pc"])({ids:e.id}).then(e=>{e.success&&(this.$Message.success("删除成功"),this.getDataList())})},handleFormatError(e){this.loading=!1,this.$Notice.warning({title:"不支持的文件格式",desc:"所选文件‘ "+e.name+" ’格式不正确, 请选择 "+this.accept+" 格式文件"})},handleMaxSize(e){this.loading=!1,this.$Notice.warning({title:"文件大小过大",desc:"所选文件‘ "+e.name+" ’大小过大, 不得超过 "+this.maxSize+"M."})},beforeUpload(){return this.loading=!0,!0},handleSuccess(e,t){this.loading=!1,e.success?(this.$Message.success("上传成功"),this.getDataList()):this.$Message.error(e.message)},handleError(e,t,s){this.loading=!1,this.$Message.error(e.toString())},setCurrentValue(e){e!==this.modalVisible&&(this.modalVisible=e)}},watch:{mode(e){this.changeAccept()},value(e){this.setCurrentValue(e)},modalVisible(e){this.$emit("input",e)}},mounted(){this.init()}},u=m,p=(s("6920"),s("2877")),g=Object(p["a"])(u,i,a,!1,null,"4b59e6ca",null);t["default"]=g.exports},"565b":function(e,t,s){e.exports=s.p+"img/play.a4e927cf.png"},"592c":function(e,t){e.exports="data:image/png;base64,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"},5970:function(e,t,s){},6920:function(e,t,s){"use strict";s("5970")},e172:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e._self._c;return t("div",[e.showOnly?e._e():t("Row",{staticClass:"operation"},[t("Button",{attrs:{type:"primary",icon:"md-add"},on:{click:e.add}},[e._v("添加文件夹")]),t("Dropdown",{on:{"on-click":e.handleTreeDropdown}},[t("Button",[e._v(" 更多操作 "),t("Icon",{attrs:{type:"md-arrow-dropdown"}})],1),t("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[t("DropdownItem",{attrs:{name:"edit",disabled:0==e.selectNode.id||-1==e.selectNode.id}},[e._v("编辑文件夹")]),t("DropdownItem",{attrs:{name:"del",disabled:0==e.selectNode.id||-1==e.selectNode.id}},[e._v("删除文件夹")]),t("DropdownItem",{attrs:{name:"refresh"}},[e._v("刷新")])],1)],1)],1),e.showOnly?e._e():t("Alert",{attrs:{"show-icon":""}},[e._v(" 当前选择： "),t("span",{staticClass:"select-title"},[e._v(e._s(e.editTitle))]),e.editTitle&&"0"!=e.selectNode.id?t("a",{staticClass:"select-clear",on:{click:e.cancelEdit}},[e._v("取消选择")]):e._e()]),t("Input",{attrs:{suffix:"ios-search",placeholder:"输入搜索文件夹名称",clearable:""},on:{"on-change":e.search},model:{value:e.searchKey,callback:function(t){e.searchKey=t},expression:"searchKey"}}),t("div",{staticStyle:{position:"relative"}},[t("div",{staticClass:"tree-bar",style:{maxHeight:e.maxHeight}},[t("Tree",{ref:"tree",attrs:{data:e.data,"load-data":e.loadData,render:e.renderContent},on:{"on-check-change":e.changeSelect,"on-select-change":e.selectTree}})],1),e.loading?t("Spin",{attrs:{size:"large",fix:""}}):e._e()],1),t("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1,width:500},model:{value:e.modalVisible,callback:function(t){e.modalVisible=t},expression:"modalVisible"}},[t("Form",{ref:"form",attrs:{model:e.form,"label-width":85,rules:e.formValidate}},[t("FormItem",{attrs:{label:"上级节点："}},[e._v(e._s(e.form.parentTitle)+" "),t("Tooltip",{staticStyle:{display:"inline-block !important"},attrs:{content:"0"==e.selectNode.id?"若需添加子目录，请先点击选择一个文件夹":"若需添加一级目录，请先取消选择当前文目录",placement:"right",transfer:"","max-width":"290"}},[t("Icon",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{type:"md-help-circle",size:"20",color:"#c5c5c5"}})],1)],1),t("FormItem",{attrs:{label:"文件夹名",prop:"title"}},[t("Input",{model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),t("FormItem",{attrs:{label:"排序值",prop:"sortOrder"}},[t("Tooltip",{attrs:{trigger:"hover",placement:"right",content:"值越小越靠前，支持小数"}},[t("InputNumber",{attrs:{max:1e3,min:0},model:{value:e.form.sortOrder,callback:function(t){e.$set(e.form,"sortOrder",t)},expression:"form.sortOrder"}})],1)],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("Button",{attrs:{type:"text"},on:{click:function(t){e.modalVisible=!1}}},[e._v("取消")]),t("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.handelSubmit}},[e._v("提交")])],1)],1)],1)},a=[],o=s("365c"),l={name:"fileCategory",props:{showOnly:{type:Boolean,default:!1}},data(){return{loading:!1,maxHeight:"500px",searchKey:"",selectNode:{},selectList:[],modalVisible:!1,modalTitle:"",editTitle:"",submitLoading:!1,form:{title:"",sortOrder:0,parentId:0},formValidate:{title:[{required:!0,message:"不能为空",trigger:"blur"}],sortOrder:[{required:!0,type:"number",message:"排序值不能为空",trigger:"change"}]},data:[],editData:{}}},methods:{init(){this.getParentList(),this.editTitle="未归档",this.selectNode={id:"0",title:"未归档"},this.$emit("on-select",this.selectNode)},renderContent(e,{root:t,node:s,data:i}){let a="md-folder-open";return"0"==i.id?a="md-pricetags":"-1"==i.id&&(a="md-star-outline"),e("span",[e("span",[e("Icon",{props:{type:a,size:16},style:{"margin-right":"8px"}}),e("span",i.title)])])},getParentList(){this.loading=!0;let e={parentId:0,delFlag:0};Object(o["Db"])(e).then(e=>{this.loading=!1,e.success&&(e.result.forEach((function(e){e.isParent&&(e.loading=!1,e.children=[],e._loading=!1)})),this.data=e.result,this.data.unshift({id:"0",title:"未归档",selected:!0},{id:"-1",title:"收藏夹",selected:!1}))})},loadData(e,t){let s={parentId:e.id,delFlag:0};Object(o["Db"])(s).then(e=>{e.success&&(e.result.forEach((function(e){e.isParent&&(e.loading=!1,e.children=[],e._loading=!1)})),t(e.result))})},search(){this.searchKey?(this.loading=!0,Object(o["Dc"])({title:this.searchKey}).then(e=>{this.loading=!1,e.success&&(this.data=e.result)})):this.getParentList()},selectTree(e){if(e.length>0){this.$refs.form.resetFields();for(let i in e[0])null==e[0][i]&&(e[0][i]="");let t=JSON.stringify(e[0]),s=JSON.parse(t);this.selectNode=s,this.form=s,this.editData=s,this.editTitle=s.title,this.$emit("on-select",this.selectNode)}else this.cancelEdit()},cancelEdit(){if("0"==this.selectNode.id)return void(this.data[0].selected=!0);let e=this.$refs.tree.getSelectedNodes()[0];e&&(e.selected=!1),this.$refs.form.resetFields(),this.editData={},this.selectNode={id:"0",title:"未归档"},this.editTitle="未归档",this.data[0].selected=!0,this.$emit("on-select",this.selectNode)},changeSelect(e){this.selectList=e},handleTreeDropdown(e){"edit"==e?this.edit():"del"==e?this.del():"refresh"==e&&this.init()},add(){this.modalType=0,"0"==this.selectNode.id||"-1"==this.selectNode.id?(this.modalTitle="添加一级文件夹",this.form={parentId:"0",parentTitle:"一级目录",sortOrder:this.data.length+1}):(this.modalTitle="添加子文件夹",this.form.children||(this.form.children=[]),this.form={parentId:this.selectNode.id,parentTitle:this.selectNode.title,sortOrder:this.form.children.length+1}),this.modalVisible=!0},edit(){"0"!=this.selectNode.id&&"-1"!=this.selectNode.id?(this.editData&&(this.form=this.editData),this.modalType=1,this.modalTitle="编辑文件夹",this.modalVisible=!0):this.$Message.warning("您还未选择要编辑的文件夹")},handelSubmit(){this.$refs.form.validate(e=>{e&&(this.submitLoading=!0,0==this.modalType?(delete this.form.id,Object(o["d"])(this.form).then(e=>{this.submitLoading=!1,e.success&&(this.$Message.success("操作成功"),this.getParentList(),this.modalVisible=!1)})):1==this.modalType&&Object(o["ab"])(this.form).then(e=>{this.submitLoading=!1,e.success&&(this.editTitle=this.form.title,this.$Message.success("操作成功"),this.getParentList(),this.modalVisible=!1)}))})},del(){"0"!=this.selectNode.id&&"-1"!=this.selectNode.id?this.$Modal.confirm({title:"确认删除",loading:!0,content:"您确认要将文件夹 "+this.selectNode.title+" 及其所有文件移入回收站， 7天内后自动彻底删除",onOk:()=>{Object(o["Qc"])({id:this.selectNode.id}).then(e=>{this.$Modal.remove(),e.success&&(this.$Message.success("操作成功"),this.init())})}}):this.$Message.warning("您还未选择要删除的文件夹")}},mounted(){let e=document.documentElement.clientHeight;this.maxHeight=Number(e-287)+"px",this.init()}},r=l,c=s("2877"),d=Object(c["a"])(r,i,a,!1,null,null,null);t["default"]=d.exports}}]);