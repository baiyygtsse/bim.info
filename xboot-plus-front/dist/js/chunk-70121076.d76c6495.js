(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-70121076"],{"42ec":function(e,t,i){},"5e46":function(e,t,i){"use strict";i.r(t);var s=function(){var e=this,t=e._self._c;return t("div",[t("div",{class:{"file-upload-wrap-nobutton":!e.showUpload}},[t("Upload",{ref:"upload",attrs:{action:e.uploadFileUrl,headers:e.accessToken,"on-success":e.handleSuccess,"on-error":e.handleError,format:e.format,accept:e.accept,"max-size":1024*e.maxSize,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.beforeUpload,"default-file-list":e.fileList,"on-preview":e.handlePreview,"on-remove":e.handleRemove}},[t("Button",{directives:[{name:"show",rawName:"v-show",value:e.showUpload,expression:"showUpload"}],attrs:{type:e.type,ghost:e.ghost,shape:e.shape,size:e.size,disabled:e.disabled,icon:e.icon}},[e._v(e._s(e.text))])],1),t("span",{directives:[{name:"show",rawName:"v-show",value:!e.showUpload&&e.fileList.length<1,expression:"!showUpload && fileList.length < 1"}]},[e._v(e._s(e.noDataText))])],1)])},a=[],n=i("365c"),l={name:"fileUpload",props:{value:null,size:String,type:String,multi:{type:Boolean,default:!1},limit:{type:Number,default:10},ghost:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},shape:String,icon:{type:String,default:"ios-cloud-upload-outline"},text:{type:String,default:"上传文件"},maxSize:{type:Number,default:5},accept:String,showUpload:{type:Boolean,default:!0},noDataText:{type:String,default:"暂无数据"},showTip:{type:Boolean,default:!0},tipSize:{type:Number,default:50}},computed:{format(){if(this.accept){let e=[];return this.accept.split(",").forEach(t=>{e.push(t.replace(".","").replace(" ",""))}),e}return[]}},data(){return{accessToken:{},currentValue:this.value,uploadFileUrl:n["Tc"],fileList:[]}},methods:{init(){this.accessToken={accessToken:this.getStore("accessToken")},this.setCurrentValue(this.value)},handleFormatError(e){this.$Notice.warning({title:"不支持的文件格式",desc:"所选文件‘ "+e.name+" ’格式不正确, 请选择 "+this.accept+" 格式文件"})},handleMaxSize(e){this.$Notice.warning({title:"文件大小过大",desc:"所选文件‘ "+e.name+" ’大小过大, 不得超过 "+this.maxSize+"M."})},beforeUpload(e){return!(this.multi&&this.fileList.length>=this.limit)||(this.$Message.warning("最多只能上传"+this.limit+"张图片"),!1)},handleSuccess(e,t,i){e.success?(this.multi?this.currentValue.push({url:e.result,name:t.name,size:t.size}):this.currentValue={url:e.result,name:t.name,size:t.size},this.$emit("input",this.currentValue),this.$emit("on-change",this.currentValue)):(t.percentage=0,t.status="fail",t.name+="（上传失败）",this.$Message.error(e.message))},handleError(e,t,i){this.$Message.error(e.toString())},handlePreview(e){let t=this.showTip&&e.size&&e.size>1024*this.tipSize*1024;t?this.$Modal.confirm({title:"文件较大提示",content:"该文件大小已超过 "+this.tipSize+" MB，确认下载？",okText:"继续下载",onOk:()=>{this.download(e)}}):this.download(e)},download(e){e.url?window.open(e.url+"?attname=&response-content-type=application/octet-stream&filename="+e.name):this.$Message.error("无效的链接")},handleRemove(e,t){if(this.multi){let e=[];t.forEach(t=>{"finished"==t.status&&e.push({url:t.url,name:t.name,size:t.size})}),this.fileList=e,this.currentValue=e}else t.length>0&&"finished"==t[0].status?(this.currentValue={url:t[0].url,name:t[0].name,size:t[0].size},this.fileList=[this.currentValue]):this.currentValue={};this.$emit("input",this.currentValue),this.$emit("on-change",this.currentValue)},setCurrentValue(e){if(e.length||0==e.length){if(!this.multi)return void this.$Message.warning("单个上传仅支持传入字符串数据类型");if(e.length>this.limit){for(let t=0;t<this.limit;t++)this.fileList.push({url:e[t].url,name:e[t].name,size:e[t].size});this.currentValue=this.fileList,this.$emit("input",this.currentValue),this.$Message.warning("最多只能上传"+this.limit+"个文件")}else this.currentValue=e,this.fileList=e}else{if(this.multi)return void this.$Message.warning("多个上传仅支持传入数组数据类型");if(!e.name&&!e.url)return;this.currentValue=e,this.fileList.push(e)}this.count=this.currentValue.length,this.$emit("on-change",this.currentValue)},clear(){this.$refs.upload.clearFiles(),this.multi?this.currentValue=[]:this.currentValue={},this.$emit("input",this.currentValue),this.$emit("on-change",this.currentValue)}},watch:{value(e){this.setCurrentValue(e)}},mounted(){this.init()}},r=l,u=(i("da22"),i("2877")),o=Object(u["a"])(r,s,a,!1,null,null,null);t["default"]=o.exports},da22:function(e,t,i){"use strict";i("42ec")}}]);