(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9e5cb108"],{2727:function(t,e,s){"use strict";s("bac8")},"47d8":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"search"},[e("Card",[e("Row",{staticClass:"operation",attrs:{align:"middle",justify:"space-between"}},[e("div",[e("Button",{directives:[{name:"show",rawName:"v-show",value:"tree"==t.showType,expression:"showType == 'tree'"}],attrs:{type:"primary",icon:"md-add"},on:{click:t.add}},[t._v("添加子节点")]),e("Button",{attrs:{icon:"md-add"},on:{click:t.addRoot}},[t._v("添加一级节点")]),e("Button",{attrs:{icon:"md-trash"},on:{click:t.delAll}},[t._v("批量删除")]),e("Button",{attrs:{icon:"md-refresh"},on:{click:t.getParentList}},[t._v("刷新")]),e("Input",{directives:[{name:"show",rawName:"v-show",value:"list"==t.showType,expression:"showType == 'list'"}],staticStyle:{width:"250px"},attrs:{suffix:"ios-search",placeholder:"输入名称搜索",clearable:""},on:{"on-change":t.search},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),e("i-switch",{directives:[{name:"show",rawName:"v-show",value:"tree"==t.showType,expression:"showType == 'tree'"}],staticStyle:{"margin-left":"5px"},attrs:{size:"large"},model:{value:t.strict,callback:function(e){t.strict=e},expression:"strict"}},[e("span",{attrs:{slot:"open"},slot:"open"},[t._v("级联")]),e("span",{attrs:{slot:"close"},slot:"close"},[t._v("单选")])])],1),e("div",[e("RadioGroup",{attrs:{type:"button"},model:{value:t.showType,callback:function(e){t.showType=e},expression:"showType"}},[e("Radio",{attrs:{title:"树结构",label:"tree"}},[e("Icon",{attrs:{type:"md-list"}})],1),e("Radio",{attrs:{title:"列表",label:"list"}},[e("Icon",{attrs:{type:"ios-apps"}})],1)],1)],1)]),e("Row",{directives:[{name:"show",rawName:"v-show",value:"tree"==t.showType,expression:"showType == 'tree'"}],attrs:{type:"flex",justify:"start",gutter:16}},[e("Col",{attrs:{sm:8,md:8,lg:8,xl:6}},[e("Alert",{attrs:{"show-icon":""}},[t._v(" 当前选择编辑： "),e("span",{staticClass:"select-title"},[t._v(t._s(t.editTitle))]),e("a",{directives:[{name:"show",rawName:"v-show",value:t.form.id&&t.editTitle,expression:"form.id && editTitle"}],staticClass:"select-clear",on:{click:t.cancelEdit}},[t._v("取消选择")])]),e("Input",{attrs:{suffix:"ios-search",placeholder:"输入名称搜索",clearable:""},on:{"on-change":t.search},model:{value:t.searchKey,callback:function(e){t.searchKey=e},expression:"searchKey"}}),e("div",{staticStyle:{position:"relative"}},[e("div",{staticClass:"tree-bar",style:{maxHeight:t.maxHeight}},[e("Tree",{ref:"tree",attrs:{data:t.data,"load-data":t.loadData,"show-checkbox":"","check-strictly":!t.strict},on:{"on-check-change":t.changeSelect,"on-select-change":t.selectTree}})],1),t.loading?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)],1),e("Col",{attrs:{sm:16,md:16,lg:16,xl:9}},[e("Form",{ref:"form",attrs:{model:t.form,"label-width":100,rules:t.formValidate}},[e("FormItem",{staticClass:"form-noheight",attrs:{label:"上级节点",prop:"parentTitle"}},[e("div",{staticStyle:{display:"flex"}},[e("Input",{staticStyle:{"margin-right":"10px"},attrs:{readonly:""},model:{value:t.form.parentTitle,callback:function(e){t.$set(t.form,"parentTitle",e)},expression:"form.parentTitle"}}),e("Poptip",{attrs:{transfer:"",trigger:"click",placement:"right-start",title:"选择上级节点",width:"250"}},[e("Button",{attrs:{icon:"md-list"}},[t._v("选择分类")]),e("div",{staticClass:"tree-bar tree-select",attrs:{slot:"content"},slot:"content"},[e("Tree",{attrs:{data:t.dataEdit,"load-data":t.loadData},on:{"on-select-change":t.selectTreeEdit}}),t.loadingEdit?e("Spin",{attrs:{size:"large",fix:""}}):t._e()],1)],1)],1)]),e("FormItem",{attrs:{label:"节点名称",prop:"title"}},[e("Input",{model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),e("FormItem",{attrs:{label:"排序值",prop:"sortOrder"}},[e("Tooltip",{attrs:{trigger:"hover",placement:"right",content:"值越小越靠前，支持小数"}},[e("InputNumber",{attrs:{max:1e3,min:0},model:{value:t.form.sortOrder,callback:function(e){t.$set(t.form,"sortOrder",e)},expression:"form.sortOrder"}})],1)],1),e("FormItem",{attrs:{label:"是否启用",prop:"status"}},[e("i-switch",{attrs:{size:"large","true-value":0,"false-value":-1},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[e("span",{attrs:{slot:"open"},slot:"open"},[t._v("启用")]),e("span",{attrs:{slot:"close"},slot:"close"},[t._v("禁用")])])],1),e("FormItem",{staticClass:"br"},[e("Button",{attrs:{loading:t.submitLoading,disabled:!t.form.id||!t.editTitle,type:"primary"},on:{click:t.submitEdit}},[t._v("修改并保存")]),e("Button",{on:{click:t.handleReset}},[t._v("重置")])],1)],1)],1)],1),e("Alert",{directives:[{name:"show",rawName:"v-show",value:"list"==t.showType,expression:"showType == 'list'"}],attrs:{"show-icon":""}},[t._v(" 已选择 "),e("span",{staticClass:"select-count"},[t._v(t._s(t.selectList.length))]),t._v(" 项 "),e("a",{staticClass:"select-clear",on:{click:t.clearSelectAll}},[t._v("清空")])]),"list"==t.showType?e("Table",{ref:"table",attrs:{"row-key":"title","load-data":t.loadData,columns:t.columns,data:t.data,loading:t.loading,border:"","update-show-children":!0},on:{"on-selection-change":t.showSelect}}):t._e()],1),e("Modal",{attrs:{title:t.modalTitle,"mask-closable":!1,width:500},model:{value:t.modalVisible,callback:function(e){t.modalVisible=e},expression:"modalVisible"}},[e("Form",{ref:"formAdd",attrs:{model:t.formAdd,"label-width":100,rules:t.formValidate}},[t.showParent?e("div",[e("FormItem",{attrs:{label:"上级节点："}},[t._v(t._s(t.form.title))])],1):t._e(),e("FormItem",{attrs:{label:"节点名称",prop:"title"}},[e("Input",{model:{value:t.formAdd.title,callback:function(e){t.$set(t.formAdd,"title",e)},expression:"formAdd.title"}})],1),e("FormItem",{attrs:{label:"排序值",prop:"sortOrder"}},[e("Tooltip",{attrs:{trigger:"hover",placement:"right",content:"值越小越靠前，支持小数"}},[e("InputNumber",{attrs:{max:1e3,min:0},model:{value:t.formAdd.sortOrder,callback:function(e){t.$set(t.formAdd,"sortOrder",e)},expression:"formAdd.sortOrder"}})],1)],1),e("FormItem",{attrs:{label:"是否启用",prop:"status"}},[e("i-switch",{attrs:{size:"large","true-value":0,"false-value":-1},model:{value:t.formAdd.status,callback:function(e){t.$set(t.formAdd,"status",e)},expression:"formAdd.status"}},[e("span",{attrs:{slot:"open"},slot:"open"},[t._v("启用")]),e("span",{attrs:{slot:"close"},slot:"close"},[t._v("禁用")])])],1)],1),e("div",{attrs:{slot:"footer"},slot:"footer"},[e("Button",{attrs:{type:"text"},on:{click:function(e){t.modalVisible=!1}}},[t._v("取消")]),e("Button",{attrs:{type:"primary",loading:t.submitLoading},on:{click:t.submitAdd}},[t._v("提交")])],1)],1)],1)},a=[],r={name:"tree",data(){return{showType:"tree",loading:!1,maxHeight:"500px",strict:!0,loadingEdit:!1,modalVisible:!1,selectList:[],showParent:!1,modalTitle:"",editTitle:"",searchKey:"",form:{id:"",title:"",parentId:"",parentTitle:"",sortOrder:0,status:0},formAdd:{},formValidate:{title:[{required:!0,message:"名称不能为空",trigger:"blur"}],sortOrder:[{required:!0,type:"number",message:"排序值不能为空",trigger:"blur"}]},submitLoading:!1,data:[],dataEdit:[],columns:[{type:"selection",width:60,align:"center"},{type:"index",width:60,align:"center"},{title:"名称",key:"title",minWidth:120,sortable:!0,tree:!0},{title:"排序",key:"sortOrder",width:150,sortable:!0,align:"center",sortType:"asc"},{title:"创建时间",key:"createTime",sortable:!0,width:200},{title:"操作",key:"action",width:300,align:"center",render:(t,e)=>t("div",[t("a",{on:{click:()=>{this.tableAdd(e.row)}}},"添加子节点"),t("Divider",{props:{type:"vertical"}}),t("a",{on:{click:()=>{this.remove(e.row)}}},"删除")])}]}},methods:{init(){this.getParentList(),this.getParentListEdit()},getParentList(){this.data=[{title:"一级1",id:"1",parentId:"0",parentTitle:"一级节点",status:0,loading:!1,sortOrder:1,createTime:"2020-12-10 19:51:59",children:[{title:"二级1",id:"2",loading:!1,parentId:"1",status:0,parentTitle:"一级1",sortOrder:2,createTime:"2020-12-10 19:51:59",children:[{title:"三级1",id:"3",status:0,parentId:"2",parentTitle:"二级1",sortOrder:3,createTime:"2020-12-10 19:51:59"}]}]},{title:"一级2",id:"4",parentId:"0",parentTitle:"一级节点",status:0,sortOrder:4,createTime:"2020-12-10 19:51:59"},{title:"一级3",id:"5",parentId:"0",parentTitle:"一级节点",status:-1,sortOrder:5,createTime:"2020-12-10 19:51:59"}]},getParentListEdit(){this.dataEdit=[{id:"0",title:"一级节点"},{title:"一级1",id:"1",parentId:"0",parentTitle:"一级节点",status:0,loading:!1,children:[{title:"二级1",id:"2",loading:!1,parentId:"1",status:0,parentTitle:"一级1",children:[{title:"三级1",id:"3",status:0,parentId:"2",parentTitle:"二级1"}]}]},{title:"一级2",id:"4",parentId:"0",parentTitle:"一级节点",status:0},{title:"一级3",id:"5",parentId:"0",parentTitle:"一级节点",status:-1}]},loadData(t,e){},search(){this.searchKey?this.data=[{title:"这里需要请求后端接口",id:"1",parentId:"0",parentTitle:"一级节点",status:0,sortOrder:1,createTime:"2020-12-10 19:51:59"},{title:"所以这里是假数据",id:"4",parentId:"0",parentTitle:"一级节点",status:0,sortOrder:2,createTime:"2020-12-10 19:51:59"},{title:"我是被禁用的节点",id:"5",parentId:"0",parentTitle:"一级节点",status:-1,sortOrder:3,createTime:"2020-12-10 19:51:59"}]:this.getParentList()},selectTree(t){if(t.length>0){this.$refs.form.resetFields();for(let i in t[0])null==t[0][i]&&(t[0][i]="");let e=JSON.stringify(t[0]),s=JSON.parse(e);this.form=s,this.editTitle=s.title}else this.cancelEdit()},cancelEdit(){let t=this.$refs.tree.getSelectedNodes()[0];t&&(t.selected=!1),this.$refs.form.resetFields(),this.form.id="",this.editTitle=""},selectTreeEdit(t){if(t.length>0){for(let i in t[0])null==t[0][i]&&(t[0][i]="");let e=JSON.stringify(t[0]),s=JSON.parse(e);if(this.form.id==s.id)return this.$Message.warning("请勿选择自己作为父节点"),void(t[0].selected=!1);this.form.parentId=s.id,this.form.parentTitle=s.title}},handleReset(){this.$refs.form.resetFields(),this.form.status=0},submitEdit(){this.$refs.form.validate(t=>{if(t){if(!this.form.id)return void this.$Message.warning("请先点击选择要修改的节点");this.submitLoading=!0,this.submitLoading=!1,this.$Message.success("编辑成功"),this.modalVisible=!1}})},submitAdd(){this.$refs.formAdd.validate(t=>{t&&(this.submitLoading=!0,this.submitLoading=!1,this.$Message.success("添加成功"),this.modalVisible=!1)})},add(){this.form.id?(this.modalTitle="添加子节点",this.showParent=!0,this.form.children||(this.form.children=[]),this.formAdd={parentId:this.form.id,sortOrder:this.form.children.length+1,status:0},this.modalVisible=!0):this.$Message.warning("请先点击选择一个节点")},addRoot(){this.modalTitle="添加一级节点",this.showParent=!1,this.formAdd={parentId:0,sortOrder:this.data.length+1,status:0},this.modalVisible=!0},changeSelect(t){this.selectList=t},clearSelectAll(){this.$refs.table.selectAll(!1)},tableAdd(t){this.form=t,this.add(),this.editTitle="";let e=this.$refs.tree.getSelectedNodes()[0];e&&(e.selected=!1)},showSelect(t){this.selectList=t},remove(t){this.selectList=[],this.selectList.push(t),this.delAll()},delAll(){this.selectList.length<=0?this.$Message.warning("您还未勾选要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectList.length+" 条数据及其下级所有数据?",loading:!0,onOk:()=>{let t="";this.selectList.forEach((function(e){t+=e.id+","})),t=t.substring(0,t.length-1),this.$Modal.remove(),this.$Message.success("删除成功"),this.selectList=[],this.cancelEdit()}})}},mounted(){let t=document.documentElement.clientHeight;this.maxHeight=Number(t-287)+"px",this.init()}},l=r,o=(s("2727"),s("2877")),d=Object(o["a"])(l,i,a,!1,null,null,null);e["default"]=d.exports},bac8:function(t,e,s){}}]);