(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c876586c","chunk-2d0d7882"],{"00c0":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{display:"flex",position:"relative"}},[t("Form",{ref:"ossForm",attrs:{model:e.oss,"label-width":110,"label-position":"left",rules:e.ossValidate}},[t("FormItem",{attrs:{label:"服务提供商",prop:"serviceName"}},[t("Select",{staticStyle:{width:"230px"},attrs:{placeholder:"请选择"},on:{"on-change":e.changeOss},model:{value:e.oss.serviceName,callback:function(t){e.$set(e.oss,"serviceName",t)},expression:"oss.serviceName"}},[t("Option",{attrs:{value:"LOCAL_OSS"}},[e._v("本地服务器")]),t("Option",{attrs:{value:"MINIO_OSS"}},[e._v("MinIO")]),t("Option",{attrs:{value:"QINIU_OSS"}},[e._v("七牛云")]),t("Option",{attrs:{value:"ALI_OSS"}},[e._v("阿里云")]),t("Option",{attrs:{value:"TENCENT_OSS"}},[e._v("腾讯云")])],1)],1),"LOCAL_OSS"!=e.oss.serviceName?t("div",[t("FormItem",{attrs:{label:"accessKey",prop:"accessKey"}},[t("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:"请输入accessKey/secretId",disabled:e.changeLoading},model:{value:e.oss.accessKey,callback:function(t){e.$set(e.oss,"accessKey",t)},expression:"oss.accessKey"}})],1),t("FormItem",{attrs:{label:"secretKey",prop:"secretKey"}},[t("Tooltip",{attrs:{placement:"right",content:"无法编辑时请先点击查看图标"}},[t("Input",{staticClass:"input-see",staticStyle:{width:"380px"},attrs:{type:"text",disabled:e.changeLoading,readonly:!e.changedOssSK,icon:"ios-eye",placeholder:"请输入secretKey"},on:{"on-click":function(t){return e.seeSecret(e.oss.serviceName)}},model:{value:e.oss.secretKey,callback:function(t){e.$set(e.oss,"secretKey",t)},expression:"oss.secretKey"}})],1)],1),"QINIU_OSS"==e.oss.serviceName?t("FormItem",{attrs:{label:"zone存储区域",prop:"zone"}},[t("Select",{staticStyle:{width:"380px"},attrs:{placeholder:"请选择存储区域",disabled:e.changeLoading},model:{value:e.oss.zone,callback:function(t){e.$set(e.oss,"zone",t)},expression:"oss.zone"}},[t("Option",{attrs:{value:-1}},[e._v("自动判断")]),t("Option",{attrs:{value:0}},[e._v("华东")]),t("Option",{attrs:{value:1}},[e._v("华北")]),t("Option",{attrs:{value:2}},[e._v("华南")]),t("Option",{attrs:{value:3}},[e._v("北美")]),t("Option",{attrs:{value:4}},[e._v("东南亚")])],1)],1):e._e(),t("FormItem",{attrs:{label:"bucket空间",prop:"bucket"}},[t("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:"请输入bucket空间名",disabled:e.changeLoading},model:{value:e.oss.bucket,callback:function(t){e.$set(e.oss,"bucket",t)},expression:"oss.bucket"}})],1),"TENCENT_OSS"==e.oss.serviceName?t("FormItem",{attrs:{label:"所属地域",prop:"bucketRegion"}},[t("dict",{attrs:{dict:"tencent_bucket_region",placeholder:"请选择或输入搜索",filterable:"",disabled:e.changeLoading,transfer:""},model:{value:e.oss.bucketRegion,callback:function(t){e.$set(e.oss,"bucketRegion",t)},expression:"oss.bucketRegion"}})],1):e._e(),t("FormItem",{attrs:{label:"endpoint域名",prop:"endpoint",error:e.errorMsg}},[t("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:e.endpointPH,disabled:e.changeLoading},model:{value:e.oss.endpoint,callback:function(t){e.$set(e.oss,"endpoint",t)},expression:"oss.endpoint"}},[t("Select",{staticStyle:{width:"80px"},attrs:{slot:"prepend",prop:"http"},slot:"prepend",model:{value:e.oss.http,callback:function(t){e.$set(e.oss,"http",t)},expression:"oss.http"}},[t("Option",{attrs:{value:"http://"}},[e._v("http://")]),t("Option",{attrs:{value:"https://"}},[e._v("https://")])],1)],1)],1)],1):t("div",[t("FormItem",{attrs:{label:"存储磁盘路径",prop:"filePath",error:e.errorMsg2}},[t("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:"例如D:/upload",disabled:e.changeLoading},model:{value:e.oss.filePath,callback:function(t){e.$set(e.oss,"filePath",t)},expression:"oss.filePath"}})],1),t("FormItem",{attrs:{label:"文件预览接口",prop:"endpoint",error:e.errorMsg}},[t("Input",{staticStyle:{width:"380px"},attrs:{type:"text",placeholder:"请输入文件预览接口"},model:{value:e.oss.endpoint,callback:function(t){e.$set(e.oss,"endpoint",t)},expression:"oss.endpoint"}},[t("Select",{staticStyle:{width:"80px"},attrs:{slot:"prepend",prop:"http",disabled:e.changeLoading},slot:"prepend",model:{value:e.oss.http,callback:function(t){e.$set(e.oss,"http",t)},expression:"oss.http"}},[t("Option",{attrs:{value:"http://"}},[e._v("http://")]),t("Option",{attrs:{value:"https://"}},[e._v("https://")])],1)],1)],1)],1),t("FormItem",[t("Button",{staticStyle:{width:"100px"},attrs:{type:"primary",disabled:e.changeLoading,loading:e.saveLoading},on:{click:e.saveEditOss}},[e._v("保存并启用")])],1)],1),e.loading?t("Spin",{attrs:{fix:""}}):e._e()],1)},i=[],r=s("365c"),n=s("76e2"),o={name:"oss",components:{dict:n["default"]},data(){return{loading:!1,changeLoading:!1,saveLoading:!1,errorMsg:"",errorMsg2:"",oss:{serviceName:"",accessKey:"",secretKey:"",endpoint:"",bucket:"",bucketRegion:"",zone:null},changedOssSK:!1,ossValidate:{serviceName:[{required:!0,message:"请选择",trigger:"change"}],accessKey:[{required:!0,message:"不能为空",trigger:"blur"}],secretKey:[{required:!0,message:"不能为空",trigger:"blur"}],endpoint:[{required:!0,message:"不能为空",trigger:"blur"}],bucket:[{required:!0,message:"不能为空",trigger:"blur"}],zone:[{required:!0,type:"number",message:"不能为空",trigger:"change"}],bucketRegion:[{required:!0,message:"不能为空",trigger:"change"}]},endpointPH:"请输入空间访问域名"}},methods:{init(){this.initOssSet()},initOssSet(){this.loading=!0,Object(r["q"])().then(e=>{if(e.success&&e.result){let t=e.result;Object(r["Ob"])(t).then(e=>{if(this.loading=!1,e.result){for(let t in e.result)null==e.result[t]&&(e.result[t]="");this.oss=e.result}else this.changedOssSK=!0})}else this.loading=!1,this.changedOssSK=!0})},changeOss(e){this.$refs.ossForm.resetFields(),this.endpointPH="ALI_OSS"==e?"请输入EndPoint(地域节点) 非Bucket域名":"TENCENT_OSS"==e?"请输入完整请求域名":"请输入空间访问域名",this.changeLoading=!0,Object(r["Ob"])(e).then(t=>{if(this.changeLoading=!1,t.result){for(let e in t.result)null==t.result[e]&&(t.result[e]="");this.oss=t.result,this.changedOssSK=!1}else this.oss={serviceName:e},"LOCAL_OSS"==this.oss.serviceName&&(this.oss.http="http://",this.oss.endpoint="127.0.0.1:9999/xboot/file/view"),this.changedOssSK=!0})},seeSecret(e){e&&Object(r["Gc"])(e).then(e=>{e.success&&(this.oss.secretKey=e.result,this.changedOssSK=!0)})},saveEditOss(){if("LOCAL_OSS"==this.oss.serviceName){if(!this.oss.http)return void(this.errorMsg="请选择http协议");if(this.errorMsg="",!this.oss.endpoint)return void(this.errorMsg="请输入文件预览接口");if(this.errorMsg="",!this.oss.filePath)return void(this.errorMsg2="请输入存储磁盘路径");this.errorMsg2="",Object(r["eb"])(this.oss).then(e=>{this.saveLoading=!1,e.success&&this.$Message.success("保存成功")})}else this.$refs.ossForm.validate(e=>{if(e){if(!this.oss.http)return void(this.errorMsg="请选择http协议");this.errorMsg="",this.saveLoading=!0,this.oss.changed=this.changedOssSK,Object(r["eb"])(this.oss).then(e=>{this.saveLoading=!1,e.success&&this.$Message.success("保存成功")})}})}},mounted(){this.init()}},l=o,c=s("2877"),d=Object(c["a"])(l,a,i,!1,null,null,null);t["default"]=d.exports},"76e2":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e._self._c;return t("div",[t("Select",{attrs:{size:e.size,loading:e.loading,placeholder:e.placeholder,multiple:e.multiple,disabled:e.disabled,filterable:e.filterable,transfer:e.transfer,clearable:e.clearable,placement:e.placement,"transfer-class-name":e.transferClassName,prefix:e.prefix,"max-tag-count":e.maxTagCount,"max-tag-placeholder":e.maxTagPlaceholder},on:{"on-change":e.handleChange,"on-query-change":e.handleQueryChange,"on-clear":e.handleClear,"on-open-change":e.handleOpenChange,"on-select":e.handleSelect},model:{value:e.currentValue,callback:function(t){e.currentValue=t},expression:"currentValue"}},e._l(e.dictData,(function(s,a){return t("Option",{key:a,attrs:{value:s.value}},[e._v(e._s(s.title))])})),1)],1)},i=[],r=s("365c"),n={name:"dict",props:{value:"",dict:String,placeholder:{type:String,default:"请选择"},placement:{type:String,default:"bottom-start"},size:String,multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},filterable:{type:Boolean,default:!1},transfer:{type:Boolean,default:!1},transferClassName:String,prefix:String,maxTagCount:Number,maxTagPlaceholder:Function,clearable:{type:Boolean,default:!0}},data(){return{currentValue:this.value,dictData:[],loading:!1}},methods:{getData(e){this.loading=!0,Object(r["Ab"])(e).then(e=>{this.loading=!1,e.success&&(this.dictData=e.result)})},handleChange(e){this.$emit("input",e),this.$emit("on-change",e)},handleQueryChange(e){this.$emit("on-query-change",e)},handleClear(){this.$emit("on-clear","")},handleOpenChange(e){this.$emit("on-open-change",e)},handleSelect(e){this.$emit("on-select",e)},setCurrentValue(e){e!==this.currentValue&&(this.currentValue=e,this.$emit("on-change",this.currentValue))}},watch:{value(e){this.setCurrentValue(e)},dict(e){this.getData(e)}},mounted(){this.getData(this.dict)}},o=n,l=s("2877"),c=Object(l["a"])(o,a,i,!1,null,null,null);t["default"]=c.exports}}]);